## https 连接 特仑苏（tls）VS tcp
- https 连接其实是http 协议的升级，基于tcp协议，使用ssl/tls协议进行加密传输。
- 这个过程是先 tcp三次握手建立连接，然后进行非对称加密，最后进行对称加密。
- 下面说下详细过程：
  - 客户端先发送hello报文
  - 服务器收到客户端的hello报文，从客户端hello报文获取客户端的随机数和tls版本，然后自己生成一个随机数和证书发送给客户端
  - 客户端收到后验证证书，证书无效报错并且断开连接。证书有效，客户端就从证书中提取服务器公钥。并且生成一个预主密钥，相当一个密码本，使用公钥将加密这个密码本，发送给服务端。
  - 服务端收到后，使用私钥解密，生成会话密钥。
  - 客户端和服务端使用会话密钥进行对称加密通信，安全。
- 为什么要使用非对称加密？
  因为对称加密的密钥是共享的，一旦密钥泄露，就会导致数据泄露。
  非对称加密的密钥是不共享的，只有公钥和私钥，公钥可以公开，私钥只能自己持有。

- 加密协议—— ssl tls新的
- tcp 三次握手后连接。
- 客户端发送hello 报文，里面包含随机数，加密套件和tls 版本（对传输数据进行加密）。
- 服务端手动hello 报文，选择合适的tls版本和加密套件，生成一个随机数，用自己的数字证书（包含公钥），发生客户端。
- 客户端收到验证证书有效后，生成预主密钥，相当一个密码本。用证书中的公钥加密后，发送给服务端。就是把这个密码本加密后发送给服务端。
- 服务端收到后，用私钥解密，生成会话密钥。
  - 客户端和服务器都使用 Client Random、Server Random 和 Pre - Master Secret 作为输入，按照 TLS 协议规定的算法来生成 Master Secret
- 客户端和服务端使用会话密钥进行**对称加密**通信，安全。

### tcp 三次握手和四次挥手
- tcp连接： 客户端发送syn 报文，设置序号x；
  服务器回复syn+sck 报文，设置序号为y； 
  客户端再发送ack报文，设置序号为y+1；进行回复，这时候两者建立会话连接

- https 配置：
  - vite 配置：
    - 开发环境：
      - 第三方库：mksert （或openssl）生成长期有效证书。
      - 使用vite-plugin-https 插件，自动生成证书，并开启https服务。
      - 缺点：如果插件没有缓存证书，每次都要生成证书，每次都要重启服务。、
      - 更优（本地开发）：
       - 使用vite-plugin-mkcert 插件，自动生成证书，并开启https服，且支持缓存。
    - 生产环境：
    - nginx：代理服务器,反向代理，支持https。

## http1.0 1.1 2.0 3.0
## HTTP 1.0
### 特点
- 连接模式 ：非持久连接，每次请求都需要建立新的 TCP 连接
- 传输方式 ：明文传输
- 资源请求 ：一个连接只能处理一个请求，串行处理
- 头部压缩 ：不支持
- 安全性 ：基本不提供安全机制
### 缺点
- 每次请求都需要三次握手和四次挥手，增加了延迟
- 不支持断点续传
- 无状态，需要使用 Cookie 等机制维护状态
## HTTP 1.1
### 进步
- 持久连接 ：默认启用持久连接（Keep-Alive），一个 TCP 连接可以处理多个请求
- 管道化 ：支持请求管道化，但存在队头阻塞问题
- 缓存控制 ：引入更多的缓存控制机制
- 断点续传 ：支持断点续传，节省带宽
- 状态码 ：增加了更多的状态码
### 缺点
- 请求仍然是按顺序处理的，存在队头阻塞问题
- 头部未压缩，存在冗余
- 仍然是明文传输
## HTTP 2.0
### 进步
- 二进制分帧 ：将请求和响应数据分割为更小的帧，并采用二进制编码
- 多路复用 ：在同一个 TCP 连接上可以并行发送多个请求或响应，彻底解决了 HTTP 1.1 的队头阻塞问题
- 头部压缩 ：使用 HPACK 算法压缩头部，减少数据传输量
- 服务器推送 ：服务器可以主动向客户端推送资源，无需客户端请求
- 优先级 ：可以为请求设置优先级，优先处理重要请求
- 安全性 ：虽然协议本身不要求加密，但实际上大多数实现都基于 HTTPS
### 缺点
- 仍然基于 TCP，存在 TCP 层面的队头阻塞问题
- 建立连接时间较长（TCP + TLS 握手）
## HTTP 3.0
### 进步
- 基于 QUIC 协议 ：摒弃了 TCP，转而使用基于 UDP 的 QUIC 协议
- 解决 TCP 队头阻塞 ：由于 QUIC 基于 UDP，不存在 TCP 层面的队头阻塞问题
- 连接迁移 ：支持连接迁移，即使 IP 地址变化也能保持连接
- 更快的连接建立 ：首次连接只需 1-RTT，后续连接可以实现 0-RTT
- 内置加密 ：QUIC 协议内置加密（基于 TLS 1.3），默认加密传输
- 改进的拥塞控制 ：更好的网络拥塞控制机制
### 优势
- 大幅减少连接建立时间
- 提高了网络切换时的稳定性
- 进一步提升了传输效率和安全性
- sse 是基于http 的长连接技术，支持持续推送
- http2.0 ：支持服务器在客户端请求一个资源是，主动推送其他相关资源。

## sse
- sse：
  - set（设定流式输出text/event-stream）Content-Type
  - 长连接keep-alive；Connection
  - 缓存no-cache，Cache-Control
  
- tcp 不能再协议层面完全解决：
  - tcp 是面向字节流的可靠传输协议
  - 必须按照顺序进行交互数据包
  - 如果某个数据包丢失，则后续数据包都会等待重连
- http 3.0 支持quic 协议
  - quic 协议基于UDP 协议，使用多路复用技术，可以同时发送多个数据包，减少延迟。
  - 资源消耗，最新，有些企业不支持。
  - 不是需要更新

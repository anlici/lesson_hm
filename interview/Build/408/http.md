## https 连接 特仑苏（tls）VS tcp
- https 连接其实是http 协议的升级，基于tcp协议，使用ssl/tls协议进行加密传输。
- 这个过程是先 tcp三次握手建立连接，然后进行非对称加密，最后进行对称加密。
- 下面说下详细过程：
  - 客户端先发送hello报文
  - 服务器收到客户端的hello报文，从客户端hello报文获取客户端的随机数和tls版本，然后自己生成一个随机数和证书发送给客户端
  - 客户端收到后验证证书，证书无效报错并且断开连接。证书有效，客户端就从证书中提取服务器公钥。并且生成一个预主密钥，相当一个密码本，使用公钥将加密这个密码本，发送给服务端。
  - 服务端收到后，使用私钥解密，生成会话密钥。
  - 客户端和服务端使用会话密钥进行对称加密通信，安全。
- 为什么要使用非对称加密？
  因为对称加密的密钥是共享的，一旦密钥泄露，就会导致数据泄露。
  非对称加密的密钥是不共享的，只有公钥和私钥，公钥可以公开，私钥只能自己持有。

- 加密协议—— ssl tls新的
- tcp 三次握手后连接。
- 客户端发送hello 报文，里面包含随机数，加密套件和tls 版本（对传输数据进行加密）。
- 服务端手动hello 报文，选择合适的tls版本和加密套件，生成一个随机数，用自己的数字证书（包含公钥），发生客户端。
- 客户端收到验证证书有效后，生成预主密钥，相当一个密码本。用证书中的公钥加密后，发送给服务端。就是把这个密码本加密后发送给服务端。
- 服务端收到后，用私钥解密，生成会话密钥。
  - 客户端和服务器都使用 Client Random、Server Random 和 Pre - Master Secret 作为输入，按照 TLS 协议规定的算法来生成 Master Secret
- 客户端和服务端使用会话密钥进行**对称加密**通信，安全。

### tcp 三次握手和四次挥手
- tcp连接： 客户端发送syn 报文，设置序号x；
  服务器回复syn+sck 报文，设置序号为y； 
  客户端再发送ack报文，设置序号为y+1；进行回复，这时候两者建立会话连接